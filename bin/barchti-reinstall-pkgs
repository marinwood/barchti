#!/bin/bash
set -e

# Reinstall all default bArchTi packages from the stable channel and downgrade any packages that are too new.

# Set the package repository to the stable mirrors
barchti-refresh-pacman

# Downgrade any packages to the stable setup
sudo pacman -Suu --noconfirm

# Ensure all packages are installed
mapfile -t packages < <(grep -v '^#' "$BARCHTI_PATH/install/barchti-base.packages" | grep -v '^$')
sudo pacman -Syu --noconfirm --needed "${packages[@]}"
