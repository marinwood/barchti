#!/bin/bash

# Set the bArchTi channel, which dictates what git branch and package repository is used.
#
# Stable uses the master branch, which only sees updates on official releases, and
# the stable package repository, which typically lags the edge by a month to ensure
# better compatibility.
#
# Edge tracks the latest package repository, but still relies on the master branch,
# so new packages which require config changes may cause conflicts or errors.
#
# Dev tracks the active development dev branch, which may include partial or broken updates,
# as well as the latest package repository. This should only be used by bArchTi developers
# and people with a lot of experience managing Linux systems.

if (($# == 0)); then
  echo "Usage: barchti-channel-set [stable|rc|edge|dev]"
  exit 1
else
  channel="$1"
fi

case "$channel" in
"stable") barchti-branch-set "master" && barchti-refresh-pacman "stable" ;;
"rc") barchti-branch-set "rc" && barchti-refresh-pacman "rc" ;;
"edge") barchti-branch-set "master" && barchti-refresh-pacman "edge" ;;
"dev") barchti-branch-set "dev" && barchti-refresh-pacman "edge" ;;
*) echo "Unknown channel: $channel"; exit 1; ;;
esac

barchti-update -y
